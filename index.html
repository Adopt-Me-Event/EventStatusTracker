<!DOCTYPE html>
<html>
<head>
    <title>Secure Multi-Tracker</title>
    <style>
        body { background: #121212; color: white; font-family: sans-serif; padding: 20px; }
        #login-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #121212; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 100; }
        input { padding: 10px; border-radius: 5px; border: none; margin-bottom: 10px; width: 200px; }
        button { padding: 10px 20px; cursor: pointer; background: #00ffcc; border: none; font-weight: bold; border-radius: 5px; }
        .card-container { display: flex; flex-wrap: wrap; gap: 15px; }
        .card { background: #1e1e1e; border: 2px solid #00ffcc; border-radius: 12px; padding: 15px; width: 230px; }
    </style>
</head>
<body>

    <div id="login-overlay">
        <h2>Enter Daily Passcode</h2>
        <input type="password" id="pass-input" placeholder="Passcode">
        <button onclick="login()">Access Tracker</button>
        <p id="err" style="color: red;"></p>
    </div>

    <div id="display" class="card-container" style="display: none;"></div>

    <script>
        let currentPass = sessionStorage.getItem("tracker_pass");

        function login() {
            const input = document.getElementById('pass-input').value;
            sessionStorage.setItem("tracker_pass", input);
            currentPass = input;
            refresh();
        }

        async function refresh() {
            if (!currentPass) return;

            const r = await fetch(`/api/data?pass=${currentPass}`);
            if (r.status === 401) {
                document.getElementById('login-overlay').style.display = 'flex';
                document.getElementById('display').style.display = 'none';
                document.getElementById('err').innerText = "Incorrect or Expired Code";
                return;
            }

            const data = await r.json();
            document.getElementById('login-overlay').style.display = 'none';
            document.getElementById('display').style.display = 'contents';
            
            const div = document.getElementById('display');
            div.innerHTML = '';
            for (let name in data) {
                const p = data[name];
                div.innerHTML += `
                    <div class="card">
                        <h2 style="color:${p.inGame?'#00ff00':'#00ffcc'}">${name}</h2>
                        <p>Bucks: ${p.bucks}</p>
                        <p>Gingerbread: ${p.gingerbread}</p>
                        <hr>
                        <p>üî® Humbug: ${p.humbug}</p>
                        <p>üõ∑ Sleighball: ${p.sleighball}</p>
                        <p>‚≠ê Starcatch: ${p.starcatch}</p>
                    </div>`;
            }
        }
        
        // Initial check and set interval
        if (currentPass) refresh();
        setInterval(refresh, 2000);
    </script>
</body>
</html>
