<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>EVENTSPLOIT WINTER TRACKER</title>
    <style>
        :root { --neon: #00ff66; --bg: #0a0a0a; --card: #0d0d0d; --border: #1a1a1a; --dev: #a333ff; --advent: #ffcc00; }
        body { background: var(--bg); color: white; font-family: 'Segoe UI', sans-serif; margin: 0; }
        .header { padding: 15px; background: #000; border-bottom: 1px solid var(--border); text-align: center; }
        .tab-bar { display: flex; justify-content: center; gap: 10px; margin: 15px 0; }
        .tab { padding: 10px 25px; cursor: pointer; background: #151515; border-radius: 6px; color: #666; font-weight: bold; border: none; }
        .tab.active { background: var(--neon); color: black; }
        
        #grid { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; padding: 10px; }
        .card { background: var(--card); border: 1px solid var(--border); padding: 20px; border-radius: 8px; width: 340px; }
        
        .player-name { color: var(--neon); font-size: 1.5em; font-weight: bold; margin: 0; }
        .loc-row { color: #666; font-size: 0.9em; margin: 5px 0; display: flex; align-items: center; gap: 5px; }
        .uptime-text { font-size: 0.75em; color: #444; margin-bottom: 10px; display: block; }
        
        .currency-row { display: flex; justify-content: space-between; font-size: 1.1em; font-weight: bold; margin: 10px 0; border-bottom: 1px solid #222; padding-bottom: 5px; }
        .advent-row { display: flex; justify-content: space-between; color: var(--advent); font-weight: bold; margin-bottom: 15px; }
        
        .mg-box { background: #050505; padding: 12px; border-radius: 6px; border: 1px solid #1a1a1a; margin: 10px 0; }
        .stat-row { display: flex; justify-content: space-between; margin: 6px 0; font-size: 0.95em; align-items: center; }
        .ready-text { color: white; font-weight: bold; }
    </style>
</head>
<body>

    <div class="header"><h2 style="color:var(--neon); margin:0;">EVENTSPLOIT WINTER TRACKER</h2></div>

    <div class="tab-bar">
        <button class="tab active" onclick="showPage('alts')">TRACKER</button>
        <button class="tab" onclick="showPage('inv')">INVENTORY</button>
    </div>

    <div id="page-alts"><div id="grid"></div></div>
    <div id="page-inv" style="display:none; padding:20px; text-align:center;"><h3>Inventory View Enabled</h3><p>Select an alt from the tracker to view assets.</p></div>

    <script>
        let players = {};

        function formatTime(s) {
            if (s <= 0) return "READY";
            let m = Math.floor(s / 60), sec = Math.floor(s % 60);
            return `${m}:${sec < 10 ? '0' : ''}${sec}`;
        }

        function formatUptime(s) {
            let h = Math.floor(s / 3600), m = Math.floor((s % 3600) / 60);
            return h > 0 ? `${h}h ${m}m` : `${m}m`;
        }

        async function sync() {
            try {
                const res = await fetch('/api/data');
                players = await res.json();
                const grid = document.getElementById('grid');
                let html = "";
                
                for(let name in players) {
                    const p = players[name];
                    html += `
                        <div class="card">
                            <h2 class="player-name">${name}</h2>
                            <div class="loc-row">üìç ${p.serverType}!${p.location}</div>
                            <span class="uptime-text">Uptime: ${formatUptime(p.uptime_raw)}</span>

                            <div class="currency-row">
                                <span>BUCKS / GINGER</span>
                                <span>${p.bucks.toLocaleString()} / ${p.gingerbread.toLocaleString()}</span>
                            </div>

                            <div class="advent-row">
                                <span>üìÖ ADVENT</span>
                                <span>${formatTime(p.advent_raw)}</span>
                            </div>

                            <div class="mg-box">
                                <div class="stat-row"><span style="color:#3498db; font-weight:bold;">${p.minigame.title}</span> <b>${p.minigame.timer}</b></div>
                            </div>

                            <div class="stat-row"><span>üî® HUMBUG HUNT</span> <b class="${p.humbug_raw <= 0 ? 'ready-text' : ''}">${formatTime(p.humbug_raw)}</b></div>
                            <div class="stat-row"><span>üõ∑ SLEIGHBALL</span> <b class="${p.sleigh_raw <= 0 ? 'ready-text' : ''}">${formatTime(p.sleigh_raw)}</b></div>
                            <div class="stat-row"><span>‚≠ê STAR CATCH</span> <b class="${p.star_raw <= 0 ? 'ready-text' : ''}">${formatTime(p.star_raw)}</b></div>
                        </div>`;
                }
                grid.innerHTML = html;
            } catch(e) {}
        }

        setInterval(sync, 1000);
        function showPage(p) { /* Toggle logic here */ }
    </script>
</body>
</html>
